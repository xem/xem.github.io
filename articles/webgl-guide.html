<!doctype html>
<meta charset=utf-8>
<meta name="viewport" content="width=device-width, user-scalable=no">
<html>
<head>
<link rel=stylesheet href="../style.css?v=4">
<title>Maxime Euzière</title>
</head>
<body class=large>

<div class="wrapper">

<header></header>

<div id=menu></div>

<main>

<style>
table { border-spacing: 0; border-collapse: collapse }
th, td { padding: 5px; width: 200px }
th { background: #eee }
h4 { margin-bottom: 0; }
ul { padding-left: 15px }
pre { margin: 3px; font-size: 12px; }
.math { margin: 15px 0 }
</style>

<div class=section id=webgl_guide>
<h2>WebGL guide</h2>
<h3>october 2019 - WIP</h3>
  
<h4>Introduction</h4>

<p>This page summarizes the book <a href="https://www.oreilly.com/library/view/webgl-programming-guide/9780133364903/ch01.html">WebGL Programming Guide</a> with tiny, editable demos. 
<p>The playground is available <a href="https://xem.github.io/webgl-guide/visualizer/#PGNhbnZhcyBpZD0iY2FudmFzIiB3aWR0aD00MDAgaGVpZ2h0PTQwMD48L2NhbnZhcz4KPHNjcmlwdD4KLy8gR2V0IHRoZSBXZWJHTCByZW5kZXJpbmcgY29udGV4dAovLyBUaGUgWCBhbmQgWSBjb29yZGluYXRlcyBhcmUgZGVmaW5lZCBiZXR3ZWVuIC0xLjAgYW5kIDEuMAp2YXIgZ2wgPSBjYW52YXMuZ2V0Q29udGV4dCgid2ViZ2wiKTsKCi8vIFZlcnRleCBzaGFkZXI6Ci8vIERlc2NyaWJlcyB0aGUgYXR0cmlidXRlcyBvZiBwb2ludHMgaW4gc3BhY2VzIChwb3NpdGlvbiwgc2l6ZSwgLi4uKQovLyAtIGdsX1Bvc2l0aW9uOiB2ZWM0KHgsIHksIHosIDEuMCkKLy8gLSBnbF9Qb2ludFNpemUgZmxvYXQKdmFyIHZzaGFkZXIgPSBgCnZvaWQgbWFpbigpIHsKICBnbF9Qb3NpdGlvbiA9IHZlYzQoMC4wLCAwLjAsIDAuMCwgMS4wKTsKICBnbF9Qb2ludFNpemUgPSAxMC4wOwp9YDsKCi8vIEZyYWdtZW50IHNoYWRlcjoKLy8gRGVzY3JpYmVzIGhvdyBlYWNoIHBpeGVsIGlzIHJlbmRlcmVkIChjb2xvciwgbGlnaHRpbmcsIC4uLikKLy8gLSBnbF9mcmFnQ29sb3I6IHZlYzQociwgZywgYiwgYWxwaGEpCnZhciBmc2hhZGVyID0gYApwcmVjaXNpb24gbWVkaXVtcCBmbG9hdDsKdm9pZCBtYWluKCkgewogIGdsX0ZyYWdDb2xvciA9IHZlYzQoMS4wLCAwLjAsIDAuMCwgMS4wKTsKfWA7CgovLyBNYWtlIGEgcHJvZ3JhbSBmcm9tIHRoZXNlIHNoYWRlcnMgYW5kIHVzZSBpdCAKdmFyIHZzID0gZ2wuY3JlYXRlU2hhZGVyKGdsLlZFUlRFWF9TSEFERVIpOwpnbC5zaGFkZXJTb3VyY2UodnMsIHZzaGFkZXIpOwpnbC5jb21waWxlU2hhZGVyKHZzKTsKCnZhciBmcyA9IGdsLmNyZWF0ZVNoYWRlcihnbC5GUkFHTUVOVF9TSEFERVIpOwpnbC5zaGFkZXJTb3VyY2UoZnMsIGZzaGFkZXIpOwpnbC5jb21waWxlU2hhZGVyKGZzKTsKCnZhciBwcm9ncmFtID0gZ2wuY3JlYXRlUHJvZ3JhbSgpOwpnbC5hdHRhY2hTaGFkZXIocHJvZ3JhbSwgdnMpOwpnbC5hdHRhY2hTaGFkZXIocHJvZ3JhbSwgZnMpOwpnbC5saW5rUHJvZ3JhbShwcm9ncmFtKTsKZ2wudXNlUHJvZ3JhbShwcm9ncmFtKTsKCi8vIENsZWFyIHRoZSBjYW52YXMncyBjb2xvciBidWZmZXIsIGluIGJsYWNrCmdsLmNsZWFyQ29sb3IoMC4wLCAwLjAsIDAuMCwgMS4wKTsKZ2wuY2xlYXIoZ2wuQ09MT1JfQlVGRkVSX0JJVCk7CgovLyBEcmF3IHBvaW50cyBvbiB0aGUgY2FudmFzJ3MgY29sb3IgYnVmZmVyCmdsLmRyYXdBcnJheXMoCiAgZ2wuUE9JTlRTLCAvLyBtb2RlCiAgMCwgICAgICAgICAvLyBzdGFydGluZyBwb2ludAogIDEsICAgICAgICAgLy8gbnVtYmVyIG9mIHBvaW50cyB0byBkcmF3Cik7Cjwvc2NyaXB0Pg==">here</a> and all the code is available <a href="https://github.com/xem/webgl-guide">on Github</a>.
<p>If you're interested in Shadertoy, WebGL raymarching and signed distance functions, check out <a href="webgl_quest.html">Webgl quest</a> and <a href="webgl_quest_2.html">Webgl quest 2</a>.

<br><br><hr><br>
<h2>2D graphics</h2>
<br>
<h4>How to draw points</h4>
<i>(from chapter 2 of the book)</i>

<ul>
<li>A vertex is a point in 3D space (coordinates: X, Y, Z)
<li>A fragment is where the scene is rendered (the pixels on your screen)
<li>In a WebGL app, two programs (vertex shader and fragment shader) are written in HLSL language and controlled by JS to render a scene on a canvas
<li>The vertex shader is executed for every vertex, and sets the variable <b>gl_Position</b> (and gl_PointSize, if we want to draw points)
<li>The fragment shader is executed for every fragment, and sets the variable <b>gl_FragColor</b>
<li>The X and Y coordinates in a WebGL canvas context go from -1 to 1, whatever the size of the canvas
<br><img src="images/webgl-guide/webgl.png">
<li>In HLSL, a float is a number written with at least one decimal (ex: 0.0, 0.1, 1.0, ...)
<li>A vec4 is an array of 4 floats representing either vertex coordinates (x, y, z, 1.0), a color (r, g, b, alpha), or anything you want. (vec2 and vec3 exist too)
<li>A mat4 is a matrix (a grid) of 4 x 4 floats. (mat2 and mat3 exist too)
</ul>

<p>Here's the simplest possible WebGL program, drawing a red point in the middle of the canvas.
<br>
<br>
<iframe height=750 src="https://xem.github.io/webgl-guide/visualizer/#PGNhbnZhcyBpZD0iY2FudmFzIiB3aWR0aD00MDAgaGVpZ2h0PTQwMD48L2NhbnZhcz4KPHNjcmlwdD4KLy8gR2V0IHRoZSBXZWJHTCByZW5kZXJpbmcgY29udGV4dAp2YXIgZ2wgPSBjYW52YXMuZ2V0Q29udGV4dCgid2ViZ2wiKTsKCi8vIFZlcnRleCBzaGFkZXI6Ci8vIERlc2NyaWJlcyB0aGUgYXR0cmlidXRlcyBvZiBwb2ludHMgaW4gc3BhY2VzIChwb3NpdGlvbiwgc2l6ZSwgLi4uKQp2YXIgdnNoYWRlciA9IGAKdm9pZCBtYWluKCkgewogIGdsX1Bvc2l0aW9uID0gdmVjNCgwLjAsIDAuMCwgMC4wLCAxLjApOwogIGdsX1BvaW50U2l6ZSA9IDEwLjA7Cn1gOwoKLy8gRnJhZ21lbnQgc2hhZGVyOgovLyBEZXNjcmliZXMgaG93IGVhY2ggcGl4ZWwgaXMgcmVuZGVyZWQgKGNvbG9yLCBsaWdodGluZywgLi4uKQp2YXIgZnNoYWRlciA9IGAKcHJlY2lzaW9uIG1lZGl1bXAgZmxvYXQ7CnZvaWQgbWFpbigpIHsKICBnbF9GcmFnQ29sb3IgPSB2ZWM0KDEuMCwgMC4wLCAwLjAsIDEuMCk7Cn1gOwoKLy8gTWFrZSBhIHByb2dyYW0gZnJvbSB0aGVzZSBzaGFkZXJzIGFuZCB1c2UgaXQgCnZhciB2cyA9IGdsLmNyZWF0ZVNoYWRlcihnbC5WRVJURVhfU0hBREVSKTsKZ2wuc2hhZGVyU291cmNlKHZzLCB2c2hhZGVyKTsKZ2wuY29tcGlsZVNoYWRlcih2cyk7Cgp2YXIgZnMgPSBnbC5jcmVhdGVTaGFkZXIoZ2wuRlJBR01FTlRfU0hBREVSKTsKZ2wuc2hhZGVyU291cmNlKGZzLCBmc2hhZGVyKTsKZ2wuY29tcGlsZVNoYWRlcihmcyk7Cgp2YXIgcHJvZ3JhbSA9IGdsLmNyZWF0ZVByb2dyYW0oKTsKZ2wuYXR0YWNoU2hhZGVyKHByb2dyYW0sIHZzKTsKZ2wuYXR0YWNoU2hhZGVyKHByb2dyYW0sIGZzKTsKZ2wubGlua1Byb2dyYW0ocHJvZ3JhbSk7CmdsLnVzZVByb2dyYW0ocHJvZ3JhbSk7CgovLyBMb2cgY29tcGlsYXRpb24gZXJyb3JzLCBpZiBhbnkKY29uc29sZS5sb2coJ3ZlcnRleCBzaGFkZXI6JywgZ2wuZ2V0U2hhZGVySW5mb0xvZyh2cykgfHwgJ09LJyk7CmNvbnNvbGUubG9nKCdmcmFnbWVudCBzaGFkZXI6JywgZ2wuZ2V0U2hhZGVySW5mb0xvZyhmcykgfHwgJ09LJyk7CmNvbnNvbGUubG9nKCdwcm9ncmFtOicsIGdsLmdldFByb2dyYW1JbmZvTG9nKHByb2dyYW0pIHx8ICdPSycpOwoKLy8gQ2xlYXIgdGhlIGNhbnZhcydzIGNvbG9yIGJ1ZmZlciwgaW4gYmxhY2sKZ2wuY2xlYXJDb2xvcigwLjAsIDAuMCwgMC4wLCAxLjApOwpnbC5jbGVhcihnbC5DT0xPUl9CVUZGRVJfQklUKTsKCi8vIERyYXcgcG9pbnRzIG9uIHRoZSBjYW52YXMncyBjb2xvciBidWZmZXIKZ2wuZHJhd0FycmF5cygKICBnbC5QT0lOVFMsIC8vIG1vZGUKICAwLCAgICAgICAgIC8vIHN0YXJ0aW5nIHBvaW50CiAgMSwgICAgICAgICAvLyBudW1iZXIgb2YgcG9pbnRzIHRvIGRyYXcKKTsKPC9zY3JpcHQ+"></iframe>

<p>The program compilation is always the same, so I've put it in a compile() function that will be used in the next chapters:

<pre style="font-size:11px"><code class="lang-js">compile = (gl, vshader, fshader) => {
  var vs = gl.createShader(gl.VERTEX_SHADER);
  gl.shaderSource(vs, vshader);
  gl.compileShader(vs);

  var fs = gl.createShader(gl.FRAGMENT_SHADER);
  gl.shaderSource(fs, fshader);
  gl.compileShader(fs);

  var program = gl.createProgram();
  gl.attachShader(program, vs);
  gl.attachShader(program, fs);
  gl.linkProgram(program);
  gl.useProgram(program);

  console.log('vertex shader:', gl.getShaderInfoLog(vs) || 'OK');
  console.log('fragment shader:', gl.getShaderInfoLog(fs) || 'OK');
  console.log('program:', gl.getProgramInfoLog(program) || 'OK');
  
  gl.clearColor(0.0, 0.0, 0.0, 1.0);
  
  return program;
}</code>
</pre>



<br><br><hr><br>

<h4>Attributes and uniforms</h4>

<ul>
<li>The main interest of a WebGL program is to send it custom values. This can be done via attributes, uniforms, varyings, and buffer objects (we'll see them later)
<li>An attribute is a global variable passed by JS to the vertex shader. Its value can change for each vertex (ex: vertex coordinates)
<li>An uniform is a global variable passed by JS to all the shaders. Its value is constant for an entire draw call (ex: a color)
</ul>
<p>


<table border style="table-layout:auto">
<tr>
<th style="max-width:50px">Qualifier<th style="max-width:50px">Type<th>GLSL<th style="width:55%">How to set its value in JS

<tr>
<td rowspan=2>attribute
<td>float
<td><pre>attribute float f;</pre>
<td><pre>gl.vertexAttrib1f(gl.getAttribLocation(program, 'f'), 1.0);</pre>

<tr>
<td>vec4
<td><pre>attribute vec4 v;</pre>
<td><pre>gl.vertexAttrib4f(gl.getAttribLocation(program, 'f'), 1.0, 2.0, 3.0, 4.0);</pre>

<tr>
<td rowspan=3>uniform
<td>float
<td><pre>uniform float f;</pre>
<td><pre>gl.uniform1f(gl.getUniformLocation(program, 'f'), 1.0);</pre>

<tr>
<td>vec4
<td><pre>uniform vec4 v;</pre>
<td><pre>gl.uniform4f(gl.getUniformLocation(program, 'f'), 1.0, 2.0, 3.0, 4.0);</pre>

<tr>
<td>mat4
<td><pre>uniform mat4 m;</pre>
<td><pre>gl.uniformMatrix4fv(
  gl.getUniformLocation(program, 'm'), false, new Float32Array([...])
);</pre>

<!--li>a varying is a global variable writable by the vertex shader and readable by the fragment shader-->
</table>

<p>Here's the same demo as before, but the position, size and color of the point are now set by JS.
<br>
<br>
<iframe height=600 src="https://xem.github.io/webgl-guide/visualizer/#PGNhbnZhcyBpZD0iY2FudmFzIiB3aWR0aD00MDAgaGVpZ2h0PTQwMD48L2NhbnZhcz4KPHNjcmlwdCBzcmM9Ii4uL21lL3dlYmdsLmpzIj48L3NjcmlwdD4KPHNjcmlwdD4KdmFyIGdsID0gY2FudmFzLmdldENvbnRleHQoIndlYmdsIik7CgovLyBWZXJ0ZXggc2hhZGVyCnZhciB2c2hhZGVyID0gYAphdHRyaWJ1dGUgdmVjNCBwb3M7CmF0dHJpYnV0ZSBmbG9hdCBzaXplOwp2b2lkIG1haW4oKSB7CiAgZ2xfUG9zaXRpb24gPSBwb3M7CiAgZ2xfUG9pbnRTaXplID0gc2l6ZTsKfWA7CgovLyBGcmFnbWVudCBzaGFkZXIKdmFyIGZzaGFkZXIgPSBgCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0Owp1bmlmb3JtIHZlYzQgY29sb3I7CnZvaWQgbWFpbigpIHsKICBnbF9GcmFnQ29sb3IgPSBjb2xvcjsKfWA7CgovLyBDb21waWxlIHByb2dyYW0KdmFyIHByb2dyYW0gPSBjb21waWxlKGdsLCB2c2hhZGVyLCBmc2hhZGVyKTsKCi8vIFNlbGVjdCB0aGUgcG9zIGF0dHJpYnV0ZSBhbmQgc2V0IGl0cyBYL1kvWiB2YWx1ZXMKLy8gTm8gbmVlZCB0byBzZXQgdGhlIDR0aCB2YWx1ZSBhcyAxLjAsIGl0J3MgdGhlIGRlZmF1bHQgdmFsdWUgaW4gYSB2ZWM0IGF0dHJpYnV0ZQogdmFyIHBvcyA9IGdsLmdldEF0dHJpYkxvY2F0aW9uKHByb2dyYW0sICdwb3MnKTsKZ2wudmVydGV4QXR0cmliM2YocG9zLCAwLjAsIDAuMCwgMC4wKTsKCi8vIFNlbGVjdCB0aGUgc2l6ZSBhdHRyaWJ1dGUgYW5kIHNldCBpdHMgdmFsdWUKdmFyIHNpemUgPSBnbC5nZXRBdHRyaWJMb2NhdGlvbihwcm9ncmFtLCAnc2l6ZScpOwpnbC52ZXJ0ZXhBdHRyaWIxZihzaXplLCAxMC4wKTsKCi8vIFNlbGVjdCB0aGUgY29sb3IgdW5pZm9ybSBhbmQgc2V0IGl0cyB2YWx1ZQp2YXIgY29sb3IgPSBnbC5nZXRVbmlmb3JtTG9jYXRpb24ocHJvZ3JhbSwgImNvbG9yIik7CmdsLnVuaWZvcm00Zihjb2xvciwgMS4wLCAwLjAsIDAuMCwgMS4wKTsKCi8vIFJlbmRlcgpnbC5jbGVhcihnbC5DT0xPUl9CVUZGRVJfQklUKTsKZ2wuZHJhd0FycmF5cyhnbC5QT0lOVFMsIDAsIDEpOwo8L3NjcmlwdD4="></iframe>

<p>The next demo shows how to add a new point with a different color every time the canvas is clicked.
<br>After each click, the only things to do are: reset canvas, set the attributes/uniforms, and call drawArrays.
<br>
<br>
<iframe height=900 src="https://xem.github.io/webgl-guide/visualizer/#PGNhbnZhcyBpZD0iY2FudmFzIiB3aWR0aD00MDAgaGVpZ2h0PTQwMD48L2NhbnZhcz4KPHA+Q2xpY2sgYW55d2hlcmUgdG8gYWRkIGEgcG9pbnQKPHNjcmlwdCBzcmM9Ii4uL21lL3dlYmdsLmpzIj48L3NjcmlwdD4KPHNjcmlwdD4KdmFyIGdsID0gY2FudmFzLmdldENvbnRleHQoIndlYmdsIik7CgovLyBWZXJ0ZXggc2hhZGVyCnZhciB2c2hhZGVyID0gYAphdHRyaWJ1dGUgdmVjNCBwb3M7CmF0dHJpYnV0ZSBmbG9hdCBzaXplOwp2b2lkIG1haW4oKSB7CiAgZ2xfUG9zaXRpb24gPSBwb3M7CiAgZ2xfUG9pbnRTaXplID0gc2l6ZTsKfWA7CgovLyBGcmFnbWVudCBzaGFkZXIKdmFyIGZzaGFkZXIgPSBgCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0Owp1bmlmb3JtIHZlYzQgY29sb3I7CnZvaWQgbWFpbigpIHsKICBnbF9GcmFnQ29sb3IgPSBjb2xvcjsKfWA7CgovLyBDb21waWxlIHByb2dyYW0KdmFyIHByb2dyYW0gPSBjb21waWxlKGdsLCB2c2hhZGVyLCBmc2hhZGVyKTsKCi8vIENsZWFyCmdsLmNsZWFyKGdsLkNPTE9SX0JVRkZFUl9CSVQpOwoKLy8gR2V0IHNoYWRlcnMgYXR0cmlidXRlcyBhbmQgdW5pZm9ybXMKdmFyIHBvcyA9IGdsLmdldEF0dHJpYkxvY2F0aW9uKHByb2dyYW0sICdwb3MnKTsKdmFyIHNpemUgPSBnbC5nZXRBdHRyaWJMb2NhdGlvbihwcm9ncmFtLCAnc2l6ZScpOwp2YXIgY29sb3IgPSBnbC5nZXRVbmlmb3JtTG9jYXRpb24ocHJvZ3JhbSwgJ2NvbG9yJyk7CgovLyBMaXN0IG9mIHBvaW50cyB0byBkcmF3CnBvaW50cyA9IFtdOwoKLy8gQ2xpY2sgbGlzdGVuZXIKY2FudmFzLm9uY2xpY2sgPSBlID0+IHsKCiAgLy8gTW91c2UgY29vcmRpbmF0ZXMgb24gY2FudmFzCiAgdmFyIHggPSBlLmNsaWVudFggLSBjYW52YXMub2Zmc2V0TGVmdDsKICB2YXIgeSA9IGUuY2xpZW50WSAtIGNhbnZhcy5vZmZzZXRUb3A7CiAgCiAgLy8gTW91c2UgY29vcmRpbmF0ZXMgaW4gWy0xOjFdIHJhbmdlCiAgeCA9ICgyICogeCAvIGNhbnZhcy53aWR0aCkgLSAxOwogIHkgPSAoLTIgKiB5IC8gY2FudmFzLmhlaWdodCkgKyAxOwogIAogIC8vIEFkZCBwb2ludCBpbiBsaXN0CiAgcG9pbnRzLnB1c2goW3gsIHldKTsKICAKICAvLyBDbGVhcgogIGdsLmNsZWFyKGdsLkNPTE9SX0JVRkZFUl9CSVQpOwogIAogIC8vIERyYXcgYWxsIHBvaW50cwogIC8vIFRoZSBjb2xvciBpcyBjb21wdXRlZCB1c2luZyB0aGUgcG9pbnRzIGNvb3JkaW5hdGVzCiAgZm9yKGkgaW4gcG9pbnRzKXsKICAgIGdsLnZlcnRleEF0dHJpYjNmKHBvcywgcG9pbnRzW2ldWzBdLCBwb2ludHNbaV1bMV0sIDAuMCk7CiAgICBnbC52ZXJ0ZXhBdHRyaWIxZihzaXplLCAxMC4wKTsKICAgIGdsLnVuaWZvcm00Zihjb2xvciwgKHBvaW50c1tpXVswXSsxKS8yLCAocG9pbnRzW2ldWzFdKzEpLzIsIDAuNSwgMS4wKTsKICAgIGdsLmRyYXdBcnJheXMoZ2wuUE9JTlRTLCAwLCAxKTsKICB9Cn0KPC9zY3JpcHQ+"></iframe>

<br><br><hr><br>

<h4>How to draw lines and triangles</h4>
<i>(from chapter 3 of the book)</i>

<ul>
<li>A buffer object can be used to pass binary data from JS to the shaders (ex: a list of vertices, a list of colors, ...)
<li>This buffer is always read as a list of numbers, formatted as one of these types:
<br>
<br>
<table border>
<tr>
<th>Name
<th>JS container
<th>WebGL type
<tr>
<td>Unsigned byte
<td>Uint8Array
<td>gl.UNSIGNED_BYTE

<tr>
<td>Signed short integer
<td>Int16Array
<td>gl.SHORT

<tr>
<td>Unsigned short integer
<td>Uint16Array
<td>gl.UNSIGNED_SHORT

<tr>
<td>Signed integer
<td>Int32Array
<td>gl.INT

<tr>
<td>Unsigned integer
<td>Uint32Array
<td>gl.UNSIGNED_INT

<tr>
<td>Floating point number
<td>Float32Array
<td>gl.FLOAT
</table>
<br>
<li>drawArrays can render points, lines and triangles in 7 different ways:
<br>
<br>
<img src="images/webgl-guide/modes.png" width=800 style="border:2px solid #ddd">
</ul>

<p>Here's the simplest way to draw a triangle. You can edit the mode on line 61 to render points or lines instead of a triangle (ex: gl.POINTS / gl.LINE_LOOP)
<br>
<br>
<iframe height=750 src="https://xem.github.io/webgl-guide/visualizer/#PGNhbnZhcyBpZD0iY2FudmFzIiB3aWR0aD00MDAgaGVpZ2h0PTQwMD48L2NhbnZhcz4KPHNjcmlwdCBzcmM9Ii4uL21lL3dlYmdsLmpzIj48L3NjcmlwdD4KPHNjcmlwdD4KdmFyIGdsID0gY2FudmFzLmdldENvbnRleHQoIndlYmdsIik7CgovLyBWZXJ0ZXggc2hhZGVyCnZhciB2c2hhZGVyID0gYAphdHRyaWJ1dGUgdmVjNCBwb3M7CnZvaWQgbWFpbigpIHsKICBnbF9Qb3NpdGlvbiA9IHBvczsKfWA7CgovLyBGcmFnbWVudCBzaGFkZXIKdmFyIGZzaGFkZXIgPSBgCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0Owp1bmlmb3JtIHZlYzQgY29sb3I7CnZvaWQgbWFpbigpIHsKICBnbF9GcmFnQ29sb3IgPSBjb2xvcjsKfWA7CgovLyBDb21waWxlIHByb2dyYW0KdmFyIHByb2dyYW0gPSBjb21waWxlKGdsLCB2c2hhZGVyLCBmc2hhZGVyKTsKCi8vIEdldCBzaGFkZXJzIGF0dHJpYnV0ZXMgYW5kIHVuaWZvcm1zCnZhciBwb3MgPSBnbC5nZXRBdHRyaWJMb2NhdGlvbihwcm9ncmFtLCAncG9zJyk7CnZhciBjb2xvciA9IGdsLmdldFVuaWZvcm1Mb2NhdGlvbihwcm9ncmFtLCAnY29sb3InKTsKCi8vIFNldCBjb2xvcgpnbC51bmlmb3JtNGYoY29sb3IsIDEuMCwgMC4wLCAwLjAsIDEuMCk7CgovLyBGaWxsIGEgYnVmZmVyIHdpdGggcGFpcnMgb2YgeC95IGNvb3JkaW5hdGVzIGFuZCBwYXNzIHRoZW0gdG8gdGhlIHBvcyBhdHRyaWJ1dGUgb2YgdGhlIHZlcnRleCBzaGFkZXIgCnZhciB2ZXJ0aWNlcyA9IG5ldyBGbG9hdDMyQXJyYXkoWzAsIDAuNSwgICAtMC41LCAtMC41LCAgIDAuNSwgLTAuNV0pOwp2YXIgYnVmZmVyID0gZ2wuY3JlYXRlQnVmZmVyKCk7CmdsLmJpbmRCdWZmZXIoZ2wuQVJSQVlfQlVGRkVSLCBidWZmZXIpOwpnbC5idWZmZXJEYXRhKGdsLkFSUkFZX0JVRkZFUiwgdmVydGljZXMsIGdsLlNUQVRJQ19EUkFXKTsKZ2wudmVydGV4QXR0cmliUG9pbnRlcigKICBwb3MsICAgICAgLy8gdGFyZ2V0CiAgMiwgICAgICAgIC8vIHNpemUKICBnbC5GTE9BVCwgLy8gdHlwZQogIGZhbHNlLCAgICAvLyBub3JtYWxpemUKICAwLCAgICAgICAgLy8gc3RyaWRlCiAgMCAgICAgICAgIC8vIG9mZnNldAopOwpnbC5lbmFibGVWZXJ0ZXhBdHRyaWJBcnJheShwb3MpOwoKLy8gQ2xlYXIgY2FudmFzCmdsLmNsZWFyKGdsLkNPTE9SX0JVRkZFUl9CSVQpOwoKLy8gUmVuZGVyCmdsLmRyYXdBcnJheXMoZ2wuVFJJQU5HTEVTLCAwLCAzKTsgLy8gZHJhdyAzIHZlcnRpY2VzIGFzIGEgdHJpYW5nbGUKPC9zY3JpcHQ+"></iframe>

<br><br><hr><br>

<h4>Translate, rotate, scale</h4>
<i>(from chapters 3 & 4 of the book)</i>

<ul>
<li>Vertices coordinates are represented on vec4's (x, y, z, 1.0) to ease matrix-based transformations. They're called homogeneous coordinates

<p>

<table border>
<tr>
<th>Transformation
<th>Transformation applied to each vertex coordinates
<th>transformation via a matrix

<tr>
<td>Identity (no change)
<td>x' = x
<br>y' = y
<br>z' = z
<td>
<math xmlns = "http://www.w3.org/1998/Math/MathML">
   <mrow>
      <mo>[</mo>
      <mtable>
         <mtr>
            <mtd><mn>x'</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>y'</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>z'</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>1</mn></mtd>
         </mtr>
      </mtable>
      <mo>]</mo>
      &nbsp;=&nbsp;
      <mo>[</mo>
      <mtable>
         <mtr>
            <mtd><mn>1</mn></mtd>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>0</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>1</mn></mtd>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>0</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>1</mn></mtd>
            <mtd><mn>0</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>1</mn></mtd>
         </mtr>
      </mtable>
      <mo>]</mo>
      &nbsp;×&nbsp;
      <mo>[</mo>
      <mtable>
         <mtr>
            <mtd><mn>x</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>y</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>z</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>1</mn></mtd>
         </mtr>
      </mtable>
      <mo>]</mo>
   </mrow>
</math>


<tr>
<td>Translation along X, Y and Z axis
<td>x' = x + Tx
<br>y' = y + Ty
<br>z' = z + Tz
<td>
<math xmlns = "http://www.w3.org/1998/Math/MathML">
   <mrow>
      <mo>[</mo>
      <mtable>
         <mtr>
            <mtd><mn>x'</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>y'</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>z'</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>1</mn></mtd>
         </mtr>
      </mtable>
      <mo>]</mo>
      &nbsp;=&nbsp;
      <mo>[</mo>
      <mtable>
         <mtr>
            <mtd><mn>1</mn></mtd>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>Tx</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>1</mn></mtd>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>Ty</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>1</mn></mtd>
            <mtd><mn>Tz</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>1</mn></mtd>
         </mtr>
      </mtable>
      <mo>]</mo>
      &nbsp;×&nbsp;
      <mo>[</mo>
      <mtable>
         <mtr>
            <mtd><mn>x</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>y</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>z</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>1</mn></mtd>
         </mtr>
      </mtable>
      <mo>]</mo>
   </mrow>
</math>

<tr>
<td>Rotation around X with an angle φ (in radians)
<td>x' = x
<br>y' = y cos φ - z sin φ
<br>z' = y sin φ + z cos φ
<td>
<math xmlns = "http://www.w3.org/1998/Math/MathML">
   <mrow>
      <mo>[</mo>
      <mtable>
         <mtr>
            <mtd><mn>x'</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>y'</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>z'</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>1</mn></mtd>
         </mtr>
      </mtable>
      <mo>]</mo>
      &nbsp;=&nbsp;
      <mo>[</mo>
      <mtable>
         <mtr>
            <mtd><mn>1</mn></mtd>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>0</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>cos φ</mn></mtd>
            <mtd><mn>-sin φ</mn></mtd>
            <mtd><mn>0</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>sin φ</mn></mtd>
            <mtd><mn>cos φ</mn></mtd>
            <mtd><mn>0</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>1</mn></mtd>
         </mtr>
      </mtable>
      <mo>]</mo>
      &nbsp;×&nbsp;
      <mo>[</mo>
      <mtable>
         <mtr>
            <mtd><mn>x</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>y</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>z</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>1</mn></mtd>
         </mtr>
      </mtable>
      <mo>]</mo>
   </mrow>
</math>

<tr>
<td>Rotation around Y with an angle θ
<td>x' = x cos θ + z sin θ
<br>y' = y
<br>z' = -x sin θ + z cos θ
<td>
<math xmlns = "http://www.w3.org/1998/Math/MathML">
   <mrow>
      <mo>[</mo>
      <mtable>
         <mtr>
            <mtd><mn>x'</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>y'</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>z'</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>1</mn></mtd>
         </mtr>
      </mtable>
      <mo>]</mo>
      &nbsp;=&nbsp;
      <mo>[</mo>
      <mtable>
         <mtr>
            <mtd><mn>cos θ</mn></mtd>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>sin θ</mn></mtd>
            <mtd><mn>0</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>1</mn></mtd>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>0</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>-sin θ</mn></mtd>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>cos θ</mn></mtd>
            <mtd><mn>0</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>1</mn></mtd>
         </mtr>
      </mtable>
      <mo>]</mo>
      &nbsp;×&nbsp;
      <mo>[</mo>
      <mtable>
         <mtr>
            <mtd><mn>x</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>y</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>z</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>1</mn></mtd>
         </mtr>
      </mtable>
      <mo>]</mo>
   </mrow>
</math>

<tr>
<td>Rotation around Z axis with an angle ψ
<td>x' = x cos ψ – y sin ψ
<br>y' = x sin ψ + y cos ψ
<br>z' = z
<td>
<math xmlns = "http://www.w3.org/1998/Math/MathML">
   <mrow>
      <mo>[</mo>
      <mtable>
         <mtr>
            <mtd><mn>x'</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>y'</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>z'</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>1</mn></mtd>
         </mtr>
      </mtable>
      <mo>]</mo>
      &nbsp;=&nbsp;
      <mo>[</mo>
      <mtable>
         <mtr>
            <mtd><mn>cos ψ</mn></mtd>
            <mtd><mn>-sin ψ</mn></mtd>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>0</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>sin ψ</mn></mtd>
            <mtd><mn>cos ψ</mn></mtd>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>0</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>1</mn></mtd>
            <mtd><mn>0</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>1</mn></mtd>
         </mtr>
      </mtable>
      <mo>]</mo>
      &nbsp;×&nbsp;
      <mo>[</mo>
      <mtable>
         <mtr>
            <mtd><mn>x</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>y</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>z</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>1</mn></mtd>
         </mtr>
      </mtable>
      <mo>]</mo>
   </mrow>
</math>

<tr>
<td>Scaling along X, Y and Z axis
<td>x' = Sx * x
<br>y' = Sy * y
<br>z' = Sz * z
<td>
<math xmlns = "http://www.w3.org/1998/Math/MathML">
   <mrow>
      <mo>[</mo>
      <mtable>
         <mtr>
            <mtd><mn>x'</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>y'</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>z'</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>1</mn></mtd>
         </mtr>
      </mtable>
      <mo>]</mo>
      &nbsp;=&nbsp;
      <mo>[</mo>
      <mtable>
         <mtr>
            <mtd><mn>Sx</mn></mtd>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>0</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>Sy</mn></mtd>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>0</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>Sz</mn></mtd>
            <mtd><mn>0</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>1</mn></mtd>
         </mtr>
      </mtable>
      <mo>]</mo>
      &nbsp;×&nbsp;
      <mo>[</mo>
      <mtable>
         <mtr>
            <mtd><mn>x</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>y</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>z</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>1</mn></mtd>
         </mtr>
      </mtable>
      <mo>]</mo>
   </mrow>
</math>

</table>

<li>Multiple transformations can be accumulated by multiplying their matrices
<li>To translate then rotate a point, multiply in this order: (〈 rotation matrix 〉 × 〈 translation matrix 〉) × 〈 original coordinates 〉
<li>Matrices and vectors can be multiplied together natively in GLSL. In JS, each term must be computed separately
<br>
<br>
<iframe height=1200 src="https://xem.github.io/webgl-guide/visualizer/#PGNhbnZhcyBpZD0iY2FudmFzIiB3aWR0aD00MDAgaGVpZ2h0PTQwMD48L2NhbnZhcz4KPHNjcmlwdCBzcmM9Ii4uL21lL3dlYmdsLmpzIj48L3NjcmlwdD4KPHNjcmlwdD4KdmFyIGdsID0gY2FudmFzLmdldENvbnRleHQoIndlYmdsIik7CgovLyBWZXJ0ZXggc2hhZGVyCnZhciB2c2hhZGVyID0gYAphdHRyaWJ1dGUgdmVjNCBwb3M7CnVuaWZvcm0gbWF0NCB0cmFuc2xhdGlvbjsKdW5pZm9ybSBtYXQ0IHJvdGF0aW9uOwp1bmlmb3JtIG1hdDQgc2NhbGU7CnZvaWQgbWFpbigpIHsKICAvLyBUcmFuc2xhdGlvbiwgdGhlbiByb3RhdGlvbiwgdGhlbiBzY2FsZQogIGdsX1Bvc2l0aW9uID0gKHNjYWxlICogKHJvdGF0aW9uICogdHJhbnNsYXRpb24pKSAqIHBvczsKfWA7CgovLyBGcmFnbWVudCBzaGFkZXIKdmFyIGZzaGFkZXIgPSBgCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0Owp1bmlmb3JtIHZlYzQgY29sb3I7CnZvaWQgbWFpbigpIHsKICBnbF9GcmFnQ29sb3IgPSBjb2xvcjsKfWA7CgovLyBDb21waWxlIHByb2dyYW0KdmFyIHByb2dyYW0gPSBjb21waWxlKGdsLCB2c2hhZGVyLCBmc2hhZGVyKTsKCi8vIEdldCBzaGFkZXJzIGF0dHJpYnV0ZXMgYW5kIHVuaWZvcm1zCnZhciBwb3MgPSBnbC5nZXRBdHRyaWJMb2NhdGlvbihwcm9ncmFtLCAncG9zJyk7CnZhciBjb2xvciA9IGdsLmdldFVuaWZvcm1Mb2NhdGlvbihwcm9ncmFtLCAnY29sb3InKTsKdmFyIHRyYW5zbGF0aW9uID0gZ2wuZ2V0VW5pZm9ybUxvY2F0aW9uKHByb2dyYW0sICd0cmFuc2xhdGlvbicpOwp2YXIgcm90YXRpb24gPSBnbC5nZXRVbmlmb3JtTG9jYXRpb24ocHJvZ3JhbSwgJ3JvdGF0aW9uJyk7CnZhciBzY2FsZSA9IGdsLmdldFVuaWZvcm1Mb2NhdGlvbihwcm9ncmFtLCAnc2NhbGUnKTsKCi8vIFNldCBjb2xvcgpnbC51bmlmb3JtNGYoY29sb3IsIDEuMCwgMC4wLCAwLjAsIDEuMCk7CgovLyBTZXQgcG9zCnZhciB2ZXJ0aWNlcyA9IG5ldyBGbG9hdDMyQXJyYXkoWzAsIDAuNSwgICAtMC41LCAtMC41LCAgIDAuNSwgLTAuNV0pOwp2YXIgYnVmZmVyID0gZ2wuY3JlYXRlQnVmZmVyKCk7CmdsLmJpbmRCdWZmZXIoZ2wuQVJSQVlfQlVGRkVSLCBidWZmZXIpOwpnbC5idWZmZXJEYXRhKGdsLkFSUkFZX0JVRkZFUiwgdmVydGljZXMsIGdsLlNUQVRJQ19EUkFXKTsKZ2wudmVydGV4QXR0cmliUG9pbnRlcihwb3MsIDIsIGdsLkZMT0FULCBmYWxzZSwgMCwgMCk7CmdsLmVuYWJsZVZlcnRleEF0dHJpYkFycmF5KHBvcyk7CgovLyBTZXQgdHJhbnNsYXRpb24gbWF0cml4ICh0cmFuc3Bvc2VkKQp2YXIgVHggPSAuODsKdmFyIFR5ID0gLS42Owp2YXIgdF9tYXRyaXggPSBuZXcgRmxvYXQzMkFycmF5KFsKICAxLjAsIDAuMCwgMC4wLCAwLjAsCiAgMC4wLCAxLjAsIDAuMCwgMC4wLAogIDAuMCwgMC4wLCAxLjAsIDAuMCwKICBUeCwgVHksIDAuMCwgMS4wCl0pOwpnbC51bmlmb3JtTWF0cml4NGZ2KHRyYW5zbGF0aW9uLCBmYWxzZSwgdF9tYXRyaXgpOwoKLy8gU2V0IHJvdGF0aW9uIG1hdHJpeCAodHJhbnNwb3NlZCkKdmFyIEIgPSAuNzsKdmFyIGNvc0IgPSBNYXRoLmNvcyhCKTsKdmFyIHNpbkIgPSBNYXRoLnNpbihCKTsKdmFyIHJfbWF0cml4ID0gbmV3IEZsb2F0MzJBcnJheShbCiAgY29zQiwgIHNpbkIsIDAuMCwgMC4wLAogIC1zaW5CLCBjb3NCLCAwLjAsIDAuMCwKICAwLjAsICAgMC4wLCAgMS4wLCAwLjAsCiAgMC4wLCAgIDAuMCwgIDAuMCwgMS4wCl0pOwpnbC51bmlmb3JtTWF0cml4NGZ2KHJvdGF0aW9uLCBmYWxzZSwgcl9tYXRyaXgpOwoKLy8gU2V0IHNjYWxlIG1hdHJpeCAodHJhbnNwb3NlZCkKdmFyIFMgPSAuNDsKdmFyIHNfbWF0cml4ID0gbmV3IEZsb2F0MzJBcnJheShbCiAgUywgICAwLjAsIDAuMCwgMC4wLAogIDAuMCwgUywgICAwLjAsIDAuMCwKICAwLjAsIDAuMCwgUywgICAwLjAsCiAgMC4wLCAwLjAsIDAuMCwgMS4wCl0pOwpnbC51bmlmb3JtTWF0cml4NGZ2KHNjYWxlLCBmYWxzZSwgc19tYXRyaXgpOwoKLy8gQ2xlYXIgY2FudmFzCmdsLmNsZWFyKGdsLkNPTE9SX0JVRkZFUl9CSVQpOwoKLy8gUmVuZGVyCmdsLmRyYXdBcnJheXMoZ2wuVFJJQU5HTEVTLCAwLCAzKTsKPC9zY3JpcHQ+"></iframe>

<p>Note: in this example, the transformation matrix (translation x rotation x scale) is computed in the fragment shader.
<br>This is easy to code, but it's not efficient in real conditions, as the computation is performed for every fragment of the program.
<br>In the next examples, it will be computed once (in JS) and passed to the shader.
</ul>


<br><br><hr><br>

<h4>Multi-attribute buffer and varying color</h4>
<i>(from chapter 5 of the book)</i>

<p><ul><li>A single buffer can hold interleaved data, for example X/Y/R/G/B values, recurring every 5 floats
<li>A varying is a global variable writable by the vertex shader and readable by the fragment shader
<li>Every fragment (pixel) inside the triangle, if it's bound to a varying color variable, will be interpolated from the color of each vertex around it
</ul>
<iframe height=850 src="https://xem.github.io/webgl-guide/visualizer/#PGNhbnZhcyBpZD0iY2FudmFzIiB3aWR0aD00MDAgaGVpZ2h0PTQwMD48L2NhbnZhcz4KPHNjcmlwdCBzcmM9Ii4uL21lL3dlYmdsLmpzIj48L3NjcmlwdD4KPHNjcmlwdD4KdmFyIGdsID0gY2FudmFzLmdldENvbnRleHQoIndlYmdsIik7CgovLyBWZXJ0ZXggc2hhZGVyCnZhciB2c2hhZGVyID0gYAphdHRyaWJ1dGUgdmVjNCBwb3M7CmF0dHJpYnV0ZSB2ZWM0IGNvbG9yOwp2YXJ5aW5nIHZlYzQgdl9jb2xvcjsKdm9pZCBtYWluKCkgewogIGdsX1Bvc2l0aW9uID0gcG9zOwogIHZfY29sb3IgPSBjb2xvcjsKfWA7CgovLyBGcmFnbWVudCBzaGFkZXIKdmFyIGZzaGFkZXIgPSBgCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0Owp2YXJ5aW5nIHZlYzQgdl9jb2xvcjsKdm9pZCBtYWluKCkgewogIGdsX0ZyYWdDb2xvciA9IHZfY29sb3I7Cn1gOwoKLy8gQ29tcGlsZSBwcm9ncmFtCnZhciBwcm9ncmFtID0gY29tcGlsZShnbCwgdnNoYWRlciwgZnNoYWRlcik7CgovLyBEZWZpbmUgdmVydGljZXMgYW5kIGNvbG9ycwp2YXIgdmVydGljZXNDb2xvcnMgPSBuZXcgRmxvYXQzMkFycmF5KFsKICAvL3ggLCAgeSwgICAgciwgICAgZywgICAgYgogIDAuMCwgICAwLjUsICAxLjAsICAwLjAsICAwLjAsIAogIC0wLjUsICAtMC41LCAwLjAsICAxLjAsICAwLjAsIAogIDAuNSwgIC0wLjUsIDAuMCwgIDAuMCwgIDEuMCwgCl0pOwogIAovLyBTYXZlIHRoZSBudW1iZXIgb2YgdmVydGljZXMgKDMpCnZhciBuID0gMzsKCi8vIEdldCB0aGUgc2l6ZSBvZiBlYWNoIGZsb2F0IGluIGJ5dGVzICg0KQp2YXIgRlNJWkUgPSB2ZXJ0aWNlc0NvbG9ycy5CWVRFU19QRVJfRUxFTUVOVDsKCi8vIENyZWF0ZSBhIGJ1ZmZlciBvYmplY3QKZ2wuYmluZEJ1ZmZlcihnbC5BUlJBWV9CVUZGRVIsIGdsLmNyZWF0ZUJ1ZmZlcigpKTsKZ2wuYnVmZmVyRGF0YShnbC5BUlJBWV9CVUZGRVIsIHZlcnRpY2VzQ29sb3JzLCBnbC5TVEFUSUNfRFJBVyk7CgovLyBCaW5kIHRoZSBhdHRyaWJ1dGUgcG9zIHRvIHRoZSAxc3QgYW5kIDJuZCBmbG9hdHMgaW4gZXZlcnkgY2h1bmsgb2YgNSBmbG9hdHMgaW4gdGhlIGJ1ZmZlcgp2YXIgcG9zID0gZ2wuZ2V0QXR0cmliTG9jYXRpb24ocHJvZ3JhbSwgJ3BvcycpOwpnbC52ZXJ0ZXhBdHRyaWJQb2ludGVyKHBvcywgMiwgZ2wuRkxPQVQsIGZhbHNlLCBGU0laRSAqIDUsIDApOwpnbC5lbmFibGVWZXJ0ZXhBdHRyaWJBcnJheShwb3MpOwogIAovLyBCaW5kIHRoZSBhdHRyaWJ1dGUgY29sb3IgdG8gdGhlIDNyZCwgNHRoIGFuZCA1dGggZmxvYXQgaW4gZXZlcnkgY2h1bmsKdmFyIGNvbG9yID0gZ2wuZ2V0QXR0cmliTG9jYXRpb24ocHJvZ3JhbSwgJ2NvbG9yJyk7CmdsLnZlcnRleEF0dHJpYlBvaW50ZXIoY29sb3IsIDMsIGdsLkZMT0FULCBmYWxzZSwgRlNJWkUgKiA1LCBGU0laRSAqIDIpOwpnbC5lbmFibGVWZXJ0ZXhBdHRyaWJBcnJheShjb2xvcik7CgovLyBDbGVhciBjYW52YXMKZ2wuY2xlYXIoZ2wuQ09MT1JfQlVGRkVSX0JJVCk7CgovLyBSZW5kZXIKZ2wuZHJhd0FycmF5cyhnbC5UUklBTkdMRVMsIDAsIG4pOwo8L3NjcmlwdD4="></iframe>

<br><br><hr><br>

<h4>Texturing</h4>
<i>(from chapter 5 of the book)</i>

<ul>
<li>Fragment interpolation can be done on a set of colors, but also on a texture image (it's called sampling in this case)
<li>Any texture (square or rectangle) has a local coordinates system that goes from 0 to 1, and every associated vertex will have texture coordinates in this system
<li>The "pixels" of the texture are called texels
<br><img src="images/webgl-guide/texture.png">
</ul>

<p>Here's an example of textured quad (a square made of two triangles). Play with the numbers to change the way the vertices and texture are mapped:
<p>
<iframe height=1150 src="https://xem.github.io/webgl-guide/visualizer/#PGNhbnZhcyBpZD0iY2FudmFzIiB3aWR0aD00MDAgaGVpZ2h0PTQwMD48L2NhbnZhcz4KPHNjcmlwdCBzcmM9Ii4uL21lL3dlYmdsLmpzIj48L3NjcmlwdD4KPHNjcmlwdD4KdmFyIGdsID0gY2FudmFzLmdldENvbnRleHQoIndlYmdsIik7CgovLyBWZXJ0ZXggc2hhZGVyCnZhciB2c2hhZGVyID0gYAphdHRyaWJ1dGUgdmVjNCBwb3M7CmF0dHJpYnV0ZSB2ZWMyIHRleENvb3JkOwp2YXJ5aW5nIHZlYzIgdl90ZXhDb29yZDsKdm9pZCBtYWluKCkgewogIGdsX1Bvc2l0aW9uID0gcG9zOwogIHZfdGV4Q29vcmQgPSB0ZXhDb29yZDsKfWA7CgovLyBGcmFnbWVudCBzaGFkZXIKdmFyIGZzaGFkZXIgPSBgCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0Owp1bmlmb3JtIHNhbXBsZXIyRCBzYW1wbGVyOwp2YXJ5aW5nIHZlYzIgdl90ZXhDb29yZDsKdm9pZCBtYWluKCkgewogIGdsX0ZyYWdDb2xvciA9IHRleHR1cmUyRChzYW1wbGVyLCB2X3RleENvb3JkKTsKfWA7CgovLyBDb21waWxlIHByb2dyYW0KdmFyIHByb2dyYW0gPSBjb21waWxlKGdsLCB2c2hhZGVyLCBmc2hhZGVyKTsKCi8vIEJ1ZmZlciAoWCxZOiB2ZXJ0ZXggY29vcmRpbmF0ZXMsIFQsVTogdGV4dHVyZSBjb29yZGluYXRlcykKdmFyIHZlcnRpY2VzVGV4Q29vcmRzID0gbmV3IEZsb2F0MzJBcnJheShbCiAgLTAuNSwgMC41LCAgMC4wLCAxLjAsCiAgLTAuNSwgLTAuNSwgMC4wLCAwLjAsCiAgMC41LCAgMC41LCAgMS4wLCAxLjAsCiAgMC41LCAgLTAuNSwgMS4wLCAwLjAsCl0pOwoKdmFyIG4gPSA0OyAvLyB2ZXJ0aWNlcyAoNCkKdmFyIEZTSVpFID0gdmVydGljZXNUZXhDb29yZHMuQllURVNfUEVSX0VMRU1FTlQ7IC8vIGJ5dGVzIHBlciBmbG9hdCAoNCkKCi8vIENyZWF0ZSB0aGUgYnVmZmVyIG9iamVjdAp2YXIgdmVydGV4VGV4Q29vcmRCdWZmZXIgPSBnbC5jcmVhdGVCdWZmZXIoKTsKZ2wuYmluZEJ1ZmZlcihnbC5BUlJBWV9CVUZGRVIsIHZlcnRleFRleENvb3JkQnVmZmVyKTsKZ2wuYnVmZmVyRGF0YShnbC5BUlJBWV9CVUZGRVIsIHZlcnRpY2VzVGV4Q29vcmRzLCBnbC5TVEFUSUNfRFJBVyk7CgovLyBVc2UgZXZlcnkgMXN0IGFuZCAybmQgZmxvYXQgZm9yIHBvcwp2YXIgcG9zID0gZ2wuZ2V0QXR0cmliTG9jYXRpb24ocHJvZ3JhbSwgJ3BvcycpOwpnbC52ZXJ0ZXhBdHRyaWJQb2ludGVyKHBvcywgMiwgZ2wuRkxPQVQsIGZhbHNlLCBGU0laRSAqIDQsIDApOwpnbC5lbmFibGVWZXJ0ZXhBdHRyaWJBcnJheShwb3MpOwoKLy8gVXNlIGV2ZXJ5IDNyZCBhbmQgNHRoIGZsb2F0IGZvciB0ZXhDb29yZAp2YXIgdGV4Q29vcmQgPSBnbC5nZXRBdHRyaWJMb2NhdGlvbihwcm9ncmFtLCAndGV4Q29vcmQnKTsKZ2wudmVydGV4QXR0cmliUG9pbnRlcih0ZXhDb29yZCwgMiwgZ2wuRkxPQVQsIGZhbHNlLCBGU0laRSAqIDQsIEZTSVpFICogMik7CmdsLmVuYWJsZVZlcnRleEF0dHJpYkFycmF5KHRleENvb3JkKTsKCi8vIFNldCBhIDJEIHRleHR1cmUKdmFyIHRleHR1cmUgPSBnbC5jcmVhdGVUZXh0dXJlKCk7CnZhciBzYW1wbGVyID0gZ2wuZ2V0VW5pZm9ybUxvY2F0aW9uKHByb2dyYW0sICdzYW1wbGVyJyk7CnZhciBpbWFnZSA9IG5ldyBJbWFnZSgpOwppbWFnZS5zcmMgPSAnLi4vYm9vay9yZXNvdXJjZXMvc2t5LmpwZyc7CmltYWdlLm9ubG9hZCA9IGZ1bmN0aW9uKCl7CgogIC8vIEZsaXAgdGhlIGltYWdlJ3MgeSBheGlzCiAgZ2wucGl4ZWxTdG9yZWkoZ2wuVU5QQUNLX0ZMSVBfWV9XRUJHTCwgMSk7CgogIC8vIEVuYWJsZSB0ZXh0dXJlIDAKICBnbC5hY3RpdmVUZXh0dXJlKGdsLlRFWFRVUkUwKTsKCiAgLy8gU2V0IHRoZSB0ZXh0dXJlJ3MgdGFyZ2V0ICgyRCBvciBjdWJlbWFwKQogIGdsLmJpbmRUZXh0dXJlKGdsLlRFWFRVUkVfMkQsIHRleHR1cmUpOwoKICAvLyBTdHJldGNoL3dyYXAgb3B0aW9ucwogIGdsLnRleFBhcmFtZXRlcmkoZ2wuVEVYVFVSRV8yRCwgZ2wuVEVYVFVSRV9NSU5fRklMVEVSLCBnbC5MSU5FQVIpOwogIAogIC8vIEJpbmQgaW1hZ2UgdG8gdGV4dHVyZQogIGdsLnRleEltYWdlMkQoZ2wuVEVYVFVSRV8yRCwgMCwgZ2wuUkdCLCBnbC5SR0IsIGdsLlVOU0lHTkVEX0JZVEUsIGltYWdlKTsKICAKICAvLyBQYXNzIHRleHR1cmUgMCB0byB0aGUgc2FtcGxlcgogIGdsLnVuaWZvcm0xaShzYW1wbGVyLCAwKTsKICAKICBnbC5jbGVhcihnbC5DT0xPUl9CVUZGRVJfQklUKTsgICAvLyBDbGVhciBjYW52YXMKICBnbC5kcmF3QXJyYXlzKGdsLlRSSUFOR0xFX1NUUklQLCAwLCBuKTsgLy8gRHJhdyB0aGUgcXVhZAp9Owo8L3NjcmlwdD4="></iframe>

<p>Similarly, multiple textures can be used at once. For example, initialize two samplers, and multiply them in the fragment shader (<a href="https://xem.github.io/webgl_guide/book/ch05/MultiTexture.html">DEMO</a>)
<pre class="language-js"><code>vec4 color0 = texture2D(sampler0, v_TexCoord);
vec4 color1 = texture2D(sampler1, v_TexCoord);
gl_FragColor = color0 * color1;</code></pre>

<br><br><hr><br>

<h2>3D graphics</h2>
<br>
<h4>3D camera</h4>
<i>(from chapter 7 of the book)</i>
<ul>
<li>In WebGL (and 3D graphics in general), the "camera" is abstract: its position, angle and perspective are defined by a "model view projection" matrix
<li>On render, every vertex in the scene is multiplied by this matrix to simulate these camera properties
<li>First, the camera's perspective (including field of view, aspect ratio, near clip plane and far clip plane) can be set with:

<div class=math>
<math xmlns = "http://www.w3.org/1998/Math/MathML">
   <mrow>
      <mo>[</mo>
      <mtable>
         <mtr>
            <mtd><mn>1/(aspect*tan(fov/2))</mn></mtd>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>0</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>1/tan(fov/2)</mn></mtd>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>0</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>-(far+near)/(far-near)</mn></mtd>
            <mtd><mn>-(2*far*near)/far-near</mn></mtd>
         </mtr>
         
         <mtr>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>0</mn></mtd>
            <mtd><mn>-1</mn></mtd>
            <mtd><mn>0</mn></mtd>
         </mtr>
      </mtable>
      <mo>]</mo>
   </mrow>
</math>
</div>

<li>Then, it can be translated, rotated and scaled (zoomed) by multiplying the corresponding matrices (see "Translate, rotate, scale" above)
<li>A LookAt() function is often used by developers to set the camera's position, angle and target all at once. It's included in the book's file <a href="https://github.com/xem/webgl-guide/blob/gh-pages/book/lib/cuon-matrix.js">cuon-matrix.js</a>
<li>I simplified the most useful camera features into three functions: multMat4Mat4(), perspective() and camera() (see <a href=https://github.com/xem/webgl-guide/blob/gh-pages/me/matrix.js">matrix.js</a>)

<pre style="columns:2;column-rule:1px solid;font-size:11px"><code class="lang-js">// Multiply 2 matrices
multMat4Mat4 = (a, b) => {
  var i, e, a, b, ai0, ai1, ai2, ai3;
  for (i = 0; i < 4; i++) {
    ai0 = a[i];
    ai1 = a[i+4];
    ai2 = a[i+8];
    ai3 = a[i+12];
    a[i]    = ai0 * b[0]  + ai1 * b[1]  + ai2 * b[2]  + ai3 * b[3];
    a[i+4]  = ai0 * b[4]  + ai1 * b[5]  + ai2 * b[6]  + ai3 * b[7];
    a[i+8]  = ai0 * b[8]  + ai1 * b[9]  + ai2 * b[10] + ai3 * b[11];
    a[i+12] = ai0 * b[12] + ai1 * b[13] + ai2 * b[14] + ai3 * b[15];
  }
};

// Set perspective
// options: fovy, aspect, near, far
perspective = (mat, options) => {
  var fovy = options.fovy || 1.5;
  var aspect = options.ratio || 1;
  var near = options.near || 1;
  var far = options.far || 100;
  var s = Math.sin(fovy);
  var rd = 1 / (far - near);
  var ct = Math.cos(fovy) / s;
  mat.set([
    ct / aspect, 0, 0, 0, 
    0, ct, 0, 0, 
    0, 0, -(far + near) * rd, -1,
    0, 0, -2 * near * far * rd, 0
  ]);
}

// Move camera
// options: x/y/z (translate), rx/ry/rz (rotate)
camera = (mat, options) => {
  var x = options.x || 0;
  var y = options.y || 0;
  var z = options.z || 0;
  var rx = options.rx;
  var ry = options.ry;
  var rz = options.rz;
  
  // translate
  if(x || y || z){
    mat[12] += mat[0] * x + mat[4] * y + mat[8]  * z;
    mat[13] += mat[1] * x + mat[5] * y + mat[9]  * z;
    mat[14] += mat[2] * x + mat[6] * y + mat[10] * z;
    mat[15] += mat[3] * x + mat[7] * y + mat[11] * z;
  }
  
  // Rotate
  if(rx) multMat4Mat4(mat, new Float32Array([1, 0, 0, 0, 
                                            0, Math.cos(rx), Math.sin(rx), 0, 
                                            0, -Math.sin(rx), Math.cos(rx), 0, 
                                            0, 0, 0, 1]));
  if(ry) multMat4Mat4(mat, new Float32Array([Math.cos(ry), 0, -Math.sin(ry), 0,
                                             0, 1, 0, 0,
                                             Math.sin(ry), 0, Math.cos(ry), 0,
                                             0, 0, 0, 1]));
  if(rz) multMat4Mat4(mat, new Float32Array([Math.cos(rz), Math.sin(rz), 0, 0,
                                             -Math.sin(rz), Math.cos(rz), 0, 0,
                                             0, 0, 1, 0,
                                             0, 0, 0, 1]));
}
</code>
</pre>

</ul>

<br><br><hr><br>

<h3>Hello cube</h3>
<i>(from chapter 7 of the book)</i>

<ul>
<li>As seen before, buffer objects with the type gl.ARRAY_BUFFER can hold vertex properties (position, color)
<li>Though, in 3D models, vertices are often shared between multiple triangles
<li>Instead of repeating the same vertices many times, we can write each vertex once, and use another buffer object with the type gl.ELEMENT_ARRAY_BUFFER that makes triangles simply by using indices of the first object
<li>In 3D, depth-sorting must be enabled with <b>gl.enable(gl.DEPTH_TEST);</b> and the screen is cleaned with <b>gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);</b>
</ul>

<iframe height=1500 src="https://xem.github.io/webgl-guide/visualizer/#PGNhbnZhcyBpZD0iY2FudmFzIiB3aWR0aD00MDAgaGVpZ2h0PTQwMD48L2NhbnZhcz4KPHNjcmlwdCBzcmM9Ii4uL21lL3dlYmdsLmpzIj48L3NjcmlwdD4KPHNjcmlwdCBzcmM9Ii4uL21lL21hdHJpeC5qcyI+PC9zY3JpcHQ+CjxzY3JpcHQ+CgovLyBDb252ZXJ0IGRlZyBpbiByYWRpYW5zCmRlZzJyYWQgPSBhbmdsZSA9PiBNYXRoLlBJICogYW5nbGUgLyAxODA7CgovLyBXZWJHTCBjYW52YXMgY29udGV4dAp2YXIgZ2wgPSBjYW52YXMuZ2V0Q29udGV4dCgid2ViZ2wiKTsKCi8vIFZlcnRleCBzaGFkZXIKdmFyIHZzaGFkZXIgPSBgCmF0dHJpYnV0ZSB2ZWM0IHBvczsKYXR0cmlidXRlIHZlYzQgY29sOwp1bmlmb3JtIG1hdDQgbXZwOwp2YXJ5aW5nIHZlYzQgdl9Db2xvcjsKdm9pZCBtYWluKCkgewogIGdsX1Bvc2l0aW9uID0gbXZwICogcG9zOwogIHZfQ29sb3IgPSBjb2w7Cn1gOwoKLy8gRnJhZ21lbnQgc2hhZGVyCnZhciBmc2hhZGVyID0gYApwcmVjaXNpb24gbWVkaXVtcCBmbG9hdDsKdmFyeWluZyB2ZWM0IHZfQ29sb3I7CnZvaWQgbWFpbigpIHsKICBnbF9GcmFnQ29sb3IgPSB2X0NvbG9yOwp9YDsKCi8vIENvbXBpbGUgcHJvZ3JhbQp2YXIgcHJvZ3JhbSA9IGNvbXBpbGUoZ2wsIHZzaGFkZXIsIGZzaGFkZXIpOwoKLy8gQ3JlYXRlIGEgY3ViZQovLwovLyAgICB2Ni0tLS0tIHY1Ci8vICAgL3wgICAgICAvfAovLyAgdjEtLS0tLS12MHwKLy8gIHwgfCAgICAgfCB8Ci8vICB8IHx2Ny0tLXwtfHY0Ci8vICB8LyAgICAgIHwvCi8vICB2Mi0tLS0tLXYzCgp2YXIgdmVydGljZXNDb2xvcnMgPSBuZXcgRmxvYXQzMkFycmF5KFsKICAgMS4wLCAgMS4wLCAgMS4wLCAgICAgMS4wLCAgMS4wLCAgMS4wLCAgLy8gdjAgV2hpdGUKICAtMS4wLCAgMS4wLCAgMS4wLCAgICAgMS4wLCAgMC4wLCAgMS4wLCAgLy8gdjEgTWFnZW50YQogIC0xLjAsIC0xLjAsICAxLjAsICAgICAxLjAsICAwLjAsICAwLjAsICAvLyB2MiBSZWQKICAgMS4wLCAtMS4wLCAgMS4wLCAgICAgMS4wLCAgMS4wLCAgMC4wLCAgLy8gdjMgWWVsbG93CiAgIDEuMCwgLTEuMCwgLTEuMCwgICAgIDAuMCwgIDEuMCwgIDAuMCwgIC8vIHY0IEdyZWVuCiAgIDEuMCwgIDEuMCwgLTEuMCwgICAgIDAuMCwgIDEuMCwgIDEuMCwgIC8vIHY1IEN5YW4KICAtMS4wLCAgMS4wLCAtMS4wLCAgICAgMC4wLCAgMC4wLCAgMS4wLCAgLy8gdjYgQmx1ZQogIC0xLjAsIC0xLjAsIC0xLjAsICAgICAwLjAsICAwLjAsICAwLjAgICAvLyB2NyBCbGFjawpdKTsKCi8vIEluZGljZXMgb2YgdGhlIHZlcnRpY2VzIGZvciBlYWNoIHRyaWFuZ2xlCnZhciBpbmRpY2VzID0gbmV3IFVpbnQ4QXJyYXkoWwogIDAsIDEsIDIsICAgMCwgMiwgMywgICAgLy8gZnJvbnQKICAwLCAzLCA0LCAgIDAsIDQsIDUsICAgIC8vIHJpZ2h0CiAgMCwgNSwgNiwgICAwLCA2LCAxLCAgICAvLyB1cAogIDEsIDYsIDcsICAgMSwgNywgMiwgICAgLy8gbGVmdAogIDcsIDQsIDMsICAgNywgMywgMiwgICAgLy8gZG93bgogIDQsIDcsIDYsICAgNCwgNiwgNSAgICAgLy8gYmFjawpdKTsKCi8vIE51bWJlciBvZiB2ZXJ0aWNlcwp2YXIgbiA9IDM2OwoKLy8gQ3JlYXRlIGEgYnVmZmVyIG9iamVjdCBmb3IgdmVydGljZXMgLyBjb2xvcnMKdmFyIHZlcnRleENvbG9yQnVmZmVyID0gZ2wuY3JlYXRlQnVmZmVyKCk7CmdsLmJpbmRCdWZmZXIoZ2wuQVJSQVlfQlVGRkVSLCB2ZXJ0ZXhDb2xvckJ1ZmZlcik7CmdsLmJ1ZmZlckRhdGEoZ2wuQVJSQVlfQlVGRkVSLCB2ZXJ0aWNlc0NvbG9ycywgZ2wuU1RBVElDX0RSQVcpOwoKLy8gQ3JlYXRlIGEgYnVmZmVyIG9iamVjdCBmb3IgaW5kZXhlcwp2YXIgaW5kZXhCdWZmZXIgPSBnbC5jcmVhdGVCdWZmZXIoKTsKZ2wuYmluZEJ1ZmZlcihnbC5FTEVNRU5UX0FSUkFZX0JVRkZFUiwgaW5kZXhCdWZmZXIpOwpnbC5idWZmZXJEYXRhKGdsLkVMRU1FTlRfQVJSQVlfQlVGRkVSLCBpbmRpY2VzLCBnbC5TVEFUSUNfRFJBVyk7CgovLyBCeXRlcyBwZXIgZmxvYXQgKDQpCnZhciBGU0laRSA9IHZlcnRpY2VzQ29sb3JzLkJZVEVTX1BFUl9FTEVNRU5UOwoKLy8gU2V0IGF0dHJpYnV0ZXMgYW5kIHVuaWZvcm1zCnZhciBwb3MgPSBnbC5nZXRBdHRyaWJMb2NhdGlvbihwcm9ncmFtLCAncG9zJyk7CmdsLnZlcnRleEF0dHJpYlBvaW50ZXIocG9zLCAzLCBnbC5GTE9BVCwgZmFsc2UsIEZTSVpFICogNiwgMCk7CmdsLmVuYWJsZVZlcnRleEF0dHJpYkFycmF5KHBvcyk7CnZhciBjb2wgPSBnbC5nZXRBdHRyaWJMb2NhdGlvbihwcm9ncmFtLCAnY29sJyk7CmdsLnZlcnRleEF0dHJpYlBvaW50ZXIoY29sLCAzLCBnbC5GTE9BVCwgZmFsc2UsIEZTSVpFICogNiwgRlNJWkUgKiAzKTsKZ2wuZW5hYmxlVmVydGV4QXR0cmliQXJyYXkoY29sKTsKdmFyIG12cCA9IGdsLmdldFVuaWZvcm1Mb2NhdGlvbihwcm9ncmFtLCAnbXZwJyk7CgovLyBFbmFibGUgM0QgZGVwdGggdGVzdApnbC5lbmFibGUoZ2wuREVQVEhfVEVTVCk7CgovLyBTZXQgY2FtZXJhIHBlcnNwZWN0aXZlIGFuZCBwb3NpdGlvbgp2YXIgbXZwTWF0cml4ID0gbmV3IEZsb2F0MzJBcnJheSgxNik7CnBlcnNwZWN0aXZlKG12cE1hdHJpeCwge2Zvdnk6IGRlZzJyYWQoMzApLCBhc3BlY3Q6IDEsIG5lYXI6IDEsIGZhcjogMTAwfSk7CmNhbWVyYShtdnBNYXRyaXgsIHt6OiAtNX0pOwoKLy8gVXBkYXRlIGNhbWVyYSBhbmdsZSBhbmQgcmUtcmVuZGVyIHRyaWFuZ2xlcyBldmVyeSAxNm1zCnNldEludGVydmFsKCgpID0+IHsKICBjYW1lcmEobXZwTWF0cml4LCB7cng6IC4wMSwgcnk6IC4wMiwgcno6IC4wMX0pOwogIGdsLnVuaWZvcm1NYXRyaXg0ZnYobXZwLCBmYWxzZSwgbXZwTWF0cml4KTsKICBnbC5jbGVhcihnbC5DT0xPUl9CVUZGRVJfQklUIHwgZ2wuREVQVEhfQlVGRkVSX0JJVCk7CiAgZ2wuZHJhd0VsZW1lbnRzKGdsLlRSSUFOR0xFUywgbiwgZ2wuVU5TSUdORURfQllURSwgMCk7Cn0sIDE2KTsKPC9zY3JpcHQ+"></iframe>

</div>

</main>

</div>

<footer></footer>

<script src="../ui.js"></script>
<script>
header();
footer();
menu();
</script>

</body>
</html>
