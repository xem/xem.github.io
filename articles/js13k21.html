<!doctype html>
<meta charset=utf-8>
<meta name="viewport" content="width=device-width, user-scalable=no">
<html>
<head>
<link rel=stylesheet href="../style.css?v=4">
<title>Maxime Euzière</title>
<base target=_blank>
</head>
<body>

<style>
.twitter-tweet { margin: 30px 0 !important; border: 3px solid #ccc; border-radius: 30px; overflow: hidden; transform: scale(.95)}
ul { padding-left: 15px }
</style>

<div class="wrapper">

<header></header>

<div id=menu></div>

<main>

<div class=section id=codegolfctober18>

<h2>JS13kGames 2021: LOSSST - A Snake in Space</h2>
<h3>August-September 2021</h3>
<p><img src="images/js13k21/large.jpg">
<br><hr><br>


<h2>A special year</h2>
<p>Welcome!
<p>2021 is a special year: it's the 10th edition of <b>JS13kGames</b>, and it will be the 10th game that I'll develop in solo!
<br>(I started in 2014, but I made 2 games in 2016 and 3 games in 2018)
<p>This making-of will cover the completion of a simple idea I've had in 2017, implemented in many forms,<br>and how I plan to make it grow outside of this competition!
<b>
<p>You can play the game <a href="https://js13kgames.com/entries/lossst-a-snake-in-space">on js13kGames.com</a>
<p>The source code is <a href="https://github.com/xem/js13k21">on Github</a>
<br><br><hr><br>
</b>

<h2>Before the jam</h2>

<p><a href="images/js13k21/before.jpg"><img src="images/js13k21/before.jpg"></a>

<p>In july, I started preparing this new installment with:
<p>- A <a href="images/js13k21/ideas.png">list of ideas</a>
<br>- A <a href="https://twitter.com/MaximeEuziere/status/1416651465951690753">successful Twitter thread</a> full of JS13k-specific tips and tools
<br>- A <a href="//xem.github.io/miniSVGcreator/">SVG creation tool</a>
<br>- A Unicode 13 "recap": <a href="https://xem.github.io/unicode13/all-js.html">all chars</a> / <a href="https://xem.github.io/unicode13/shapes-js.html">all shapes</a> / <a href="https://xem.github.io/unicode13/emoji.html">all emoji</a> (and an emoji webfont useable in JS13k entries)
<br>- A <a href="https://xem.github.io/3Dmapeditor/">3D map editor</a> in CSS3D
<br>- A <a href="https://github.com/xem/mini2DPlatformer">Mini 2D platformer bootstrap</a>
<br>- A <a href="https://github.com/xem/mini3DPlatformer">Mini 3D platformer bootstrap</a>
<br>- A <a href="https://xem.github.io/int2unicode/">tool to convert a list of numbers into an ASCII or Unicode string</a>
<br>- <a href="https://twitter.com/MaximeEuziere/status/1425504758173945864">One-div CSS3D cubes</a> (while doing them, I found a super simple way to implement a <a href="https://github.com/xem/css3dcube/blob/gh-pages/camera/index.html#L38-L43"> camera in CSS3D!</a>)

<p>All these tools plus all the others I made earlier are available in the <a href="https://js13kgames.github.io/resources/">JS13k resource page</a>


<br>
<p>But an impressive game-changing tool also appeared this year, developed by <b>Yurume</b>:
<br>an entry compressor called <a href="https://lifthrasiir.github.io/roadroller/">RoadRoller</a>, allowing to lose an extra 1-2kb in a fully optimized 13kb zip file! 🤯 

<br><br><hr><br>

<h2>Day 1: the theme</h2>

<p>So the theme is <b>SPACE</b>!
<p>No code today (my love has gone away): day one is dedicated to brainstorming!
<p>I kinda had in mind to do a 3D platformer a la Mario 64, but it wouldn't really fit that theme. So let's find something else!
<p>I scribbled a list of ideas, removed the ones that risked to be over-represented among the other entries, and replayed some of my favourite space-themed mobile games, in particular <b>Escape</b>, <b>Space Frontier</b> and <b>Armory & Machine</b>
<p><img src="images/js13k21/1.jpg">
<p>The last idea I wrote in my notepad was "a sequel to a puzzle game (...) in space", and that's what I picked:<br>I'll do a sequel to <b>LOSSST</b>, my #1 entry from 2017!
<br>
<br>
<p><b>The history of LOSSST</b>
<br><br><b>Summer 2017</b>: idea of the concept, development of <a href="https://js13kgames.com/entries/lossst">the js13k entry LOSSST</a> that arrived #1 on mobile / #2 on desktop that year.<br>This entry and its <a href="//xem.github.io/articles/js13k17.html">making-of</a> were a huge success, though in retrospect, there are many things I would have done differently: the visuals (rooms are too repetitive, snakes made of cubes looked weird, tutorial signposts were not visible enough...), the clumsy CSS3D, the controls (backtracking / moving up and down was difficult), the "exploration / eat apples to grow" thing added a huge unnecessary complexity, and most of all, on a more personal note, I kind of burned out and gained too much weight while developing it, and I regret that.
<p><img src="images/js13k21/1b.jpg" width=600>

<p><b>January 2018</b>: I developed a 1kb demake of LOSSST with the Codegolf Team, containing 55 levels.<br>Some of them were never seen before. It was a very fun compression challenge, and it can be played <a href="https://js1k.com/2018-coins/demo/3003">HERE</a>.
 
<p><img src="images/js13k21/1c.jpg" width=600>

<p><b>January-June 2018</b>: I start developing a HD remake of LOSSST with new mechanics, new puzzles, better controls, mp3 musics, photorealistic textures, different environments, better controls, and even a boss fight.<br>The goal was to eventually publish it on Steam and/or mobile app stores.<br>Unfortunately, the game was handicaped because of the still clumsy CSS3D engine and the heavy textures, and remained unfinished.<br>Many lessons were learned though.<br>And it's still playable <a href="https://xem.github.io/LOSSST/">HERE</a>! 
<p><img src="images/js13k21/1d.jpg" width=600>

<p><b>May 2019</b>: bored with all these cubic snakes, I start to think of a way to represent a volumetric snake out of CSS3D circles and rectangles. You can see a live demo of the result <a href="https://codepen.io/xem/pen/XwroXG">HERE</a> (use mouse to rotate camera vertically).
<p><img src="images/js13k21/1e.jpg" width=600>
<br>It's a good start! (Even if the body looks a bit flat, the head really looks like a sphere)...
<br>But this simple demo required a large amount of work to position everything correctly, and it would be a nightmare to animate...
<br>Which gave me the idea to develop...

<p><b>June-august 2020</b>: ... a <a href="https://xem.github.io/CSS3Dframework/">CSS3D framework</a>. With it, setting up the camera, a plane, a cube, a sprite (always facing the camera), or moving an object takes a tiny line of code. The framework itself is 1.4kb zipped, and it would literally have saved me dozens of hours (and probably many kbs) while I was developing the first LOSSST game. I used it to make my 2020 entry: <a href="https://js13kgames.com/entries/track-not-found">Track not found?!</a>
<p><img src="images/js13k21/bob.jpg" width=300>

<p><b>Back to august 13, 2021</b>: the idea to redevelop LOSSST (and expand it) as a mobile game (with a succession of puzzles of increasing difficulty and extra challenges for each) has grown in my head, and instead of doing it on my free time, let it be my 2021 js13k entry!
<br>
<br>
<p><b>How I will proceed</b>

<p>I will make the game I want: a succession of puzzles, a lot of puzzles, with various mechanics, environments and musics, a story, and at the end, puzzles that take place in space (to fit the theme).
<p>No exploration, no apples, no clumsy CSS3D, no barely-visible tutorial signposts
<br>No planning: each day I will work on whatever I feel like working the most.
<br>No burn out: 2-5 hours of work per day, with pauses. Self-care is important.
<br>No staying stuck for hours because of a problem. If a problem occurs, I'll go take a walk or go to sleep, let my subconscious think about it, and the solution will be trivial when I get back.
<p>Stats: every day, I'll <a href="https://twitter.com/MaximeEuziere/status/1426588514767052800">record my screen</a> while I code, and share the number of hours spent, the size of my commented code and my progress on Twitter. I'll check out the zipped size once a week.
<p>Last but not least: leave time for beta-testing, debugging and golfing; Don't leave anything for the last minute (like mobile controls), or hope that someone will help me complete my game (especially for the music... like I do every year)
<br><br><hr><br>

<h2>Day 2: what's on the menu?</h2>

<p>Brainstorming continues... my idea for now is to build a rocket from different worlds by completing their puzzles.
<p>I scribbled ideas in my notepad and started coding a first draft of my menu...
<p><video src="images/js13k21/2-1.mp4" width=600 height=450 controls style=background:#000>
<p>I drew the rocket pieces in my SVG creator tool, and made a random stars pattern with a tiny SVG snippet inspired by old codegolf projects like <a href="https://xem.github.io/miniCliffordAttractor/">miniCliffordAttractor</a>:
<pre class=lang-html><code>&lt;svg fill="#aaa" onload="for(i=500;i--;)innerHTML+=`&lt;text x=${Math.random()*5000} y=${Math.random()*5000}>.&lt;/text>`">&lt;/svg></code></pre>

Demo:
<br>
<svg style="background:#000" onload="for(i=100;i--;)innerHTML+=`<text fill='#aaa' x=${Math.random()*300} y=${Math.random()*150}>.</text>`"></svg>

<p>To make the page behave well on mobile (and make it installable as a mobile web-app), I used the following lines at the beginning of my HTML:
<pre class=lang-html><code>&lt;meta name=viewport content="width=device-width,initial-scale=1">
&lt;meta name=apple-mobile-web-app-capable content=yes>
&lt;meta name=mobile-web-app-capable content=yes></code></pre>
<br>
<p><b>Total</b>: 1h30, 1.2kb. <a href="https://www.youtube.com/watch?v=TNFbeIYd87Q">Watch timelapse</a>

<br><br><hr><br>

<h2>Day 3: draw me a snake</h2>

<p>I started this day by completing my menu with <a href="https://twitter.com/MaximeEuziere/status/1426812340574502915">a nice scrollbar</a> that will look the same on all browsers.

<p>Then, I started working on my snake.
<br>I really wanted to find a way to push CSS3D further, <a href="https://twitter.com/MaximeEuziere/status/1426986161591959559">like I did every year since 2017</a>, so I started placing CSS3D circles in my scene to represent the joints of my snake (still wondering how I'll do the "cylinders" between each pair of joints)...
<br>But a happy accident while writing my for-loop rendered the circles too close from each other, which ended up rendering the volumetric snake I had always wanted, by surprise! yay #serendipity
<br>So I went with that and never had to implement the cylinders :D 
<p><img src="images/js13k21/3-1.gif" width=400>
<p>The snake above takes "only" 44 divs. In my 2017 game LOSSST, a "cubic" snake with the same length required about 50 divs. So, against all odds, this snake is better-looking but also more efficient for the DOM!

<p>After I tweeted it, our beloved judge <b>McFunkyPants</b> suggested that I alternate the colors of my circles, and it was an excellent idea. Doing this allowed me to offset my circles more and use even less divs (26):
<p><img src="images/js13k21/3-2.png" width=400>

<p>As you can see in that image (catured on Safari), the old-fashion emoji shadows (color:transparent + black text-shadow) don't work well with the Twemoji webfont. Only with the native emoji (which, unfortunately, areuugly, and ugly differently depending on the OS you're using).
<p>So I searched a different, cross-browser way to shade these emoji, and I finally found it a few days later, using <b>Browserstack</b>'s remote iPhone & devtools:

<pre class=lang-css><code>.emoji.shadow { filter: contrast(0)brightness(0); opacity: .6 }</code></pre>

<p><img src="images/js13k21/5-1.jpg" width=600>

<br>
<p><b>Total</b>: 3h30, 4.45kb. <a href="https://www.youtube.com/watch?v=bcZE06S3Aes">Watch timelapse</a>


<br><br><hr><br>

<h2>Day 4: new grounds</h2>

<p>On day 4 I had the huge chance to find <b>finnhvman</b>'s <a href="https://codepen.io/collection/DRMKdB">micro SVG patterns</a> on Codepen, and I decided to not only use them in my game, but also contact him to help me make more!

<p><img src="images/js13k21/4-2.jpg">

<p>The banded grass looks gorgeous, compared to a simple green radial-gradient: 
<p><video src="images/js13k21/4.mp4" width=600 height=450 controls style=background:#000>
<p>In my CSS, I applied a transparent-to-black radial background on top of the SVG background to make the ground look less flat, and more like a sphere (but in reality, it's just a rounded div).

<p>Besides that, implementing the camera rotation with the mouse / finger required very little JS code:
<details><summary>See code</summary>
<pre class=lang-js><code>pointerdown = 0;
// Pointer down (mouse or finger)
onmousedown = ontouchstart = e => {

  // Tactile devices: consider the first finger only
  if(e.touches) e = e.touches[0];
  
  // Set pointer down flag
  pointerdown = 1;
  
  // Save pointer position
  px = e.pageX;
  py = e.pageY;
}

// Pointer up
ontouchend = onmouseup = e => {
  
  // Clear pointer down flag
  pointerdown = 0;
}

// Pointer move
onmousemove = ontouchmove = e => {
  var dx, dy;
  
  // Tactile device: consider the first finger only
  if(e.touches) e = e.touches[0];

  // Find cursor delta X/Y since pointer down or last pointer move
  dx = px - e.pageX;
  dy = py - e.pageY;
    
  // Rotate around X axis according to delta Y
  rx += dy / 10;
    
  // Rotate around Z axis according to delta X
  rz += dx / 10;
  
  // Re-set last pointer position using the current ones
  px = e.pageX;
  py = e.pageY;
    
  // Rotate camera using CSS3DFramework
  C.camera({rx,rz});
}</code></pre>
</details>

<br>
<p><b>Total</b>: 6h45, 5.5kb. <a href="">Watch timelapse</a>

<br><br><hr><br>

<h2>Days 5/6: didn't lift a finger</h2>

<p>My next goal was to make the snake controllable using the mouse or the finger, by dragging its head on the stage.
<p>Working on this feature took almost two days, because desktops and mobiles had a very weird support for what I was looking for:
<br>To make the snake follow the pointer (mouse or finger), I needed to know where the pointer is on the scene, and compare it to the head's position. But retrieving the mouse coordinates inside a div requires <b>e.layerX/layerY</b> on Firefox and <b>e.offsetX/offsetY</b> on Webkit. Though, touch events don't support this feature at all.

<p><img src="images/js13k21/day5.gif">

<p>So I went with another idea that I had found while I was working on LOSSST HD: put 4 almost transparent divs around the snake's head, and make it move as soon as one of these divs is touched with the mouse or finger, using <b>document.elementFromPoint(e.clientX,e.clientY)</b>

<p><img src="images/js13k21/day6b.gif">

<p>Unfortunately, this way to control the snake wasn't precise enough on little screens, and even confusing for wall puzzles and 3D puzzles, so a few days later I scraped it entirely to save a few dozen bytes.<br>Instead, desktop players will use the arrow keys, and mobile players a virtual D-pad.

<p>Like every year, the end of the first week is also the occasion to clean up my code and split my project into multiple files... (getting used to this hierarchy always takes a few days, but it's better than a single, 200kb index.html file, I guess.)
<p><img src="images/js13k21/day6.png">

<p>I also made a comparison of my scene with and without CSS radial gradients and shadows. Quite impressive:
<p><img src="images/js13k21/day5.png" width=600>
<p>(The final game has much less shadows than the right image, I tried to use as few shadows as possible to not overwhelm people with them)


<br>
<p><b>Total</b>: 14h, 20kb. <a href="https://www.youtube.com/watch?v=oVOIPjPpE_o">Watch day 5 timelapse</a> / <a href="https://www.youtube.com/watch?v=9pTdovAcPtg">Watch day 6 timelapse</a>



<br><br><hr><br>

<h2>Day 7: move your body</h2>

<p>I took the time to test different ways to move the snake's body, and <a href="https://twitter.com/MaximeEuziere/status/1428261233619263492">asked people which one they prefer</a>.
<p><img src="images/js13k21/day7.gif" width=500>
<p>My favourite approach (#3) was also <a href="images/js13k21/day7.png">chosen by the other devs</a>... even if it looks less natural than the others.
So I went with it!

<p>Besides that, I implemented collisions (the snake can't move over itself) and backtracking (when pulling the head to the position from which it's coming)...
<p><img src="images/js13k21/day7b.gif" width=500>

<p>... and wrote the code responsible to check if the puzzles are solved.
<p><img src="images/js13k21/day7c.gif" width=500>


<br>
<p><b>Total</b>: 17h30, 26kb, 4kb zipped. <a href="https://www.youtube.com/watch?v=T_-CYHQYMRk">Watch timelapse</a>


<br><br><hr><br>

<h2>Days 8/9: puzzled</h2>

<p>I developed new puzzle types: the ones with wall, and the ones with floor + wall...
<br>
<br>
<video src="images/js13k21/8.mp4" width=600 height=450 controls style=background:#000>

<p>And the ones with wrapping:
<br>
<br>
<video src="images/js13k21/day9.mp4" width=600 height=450 controls style=background:#000>

<p>This is when I added keyboard controls an realized I'll have to scrap the "drag head to move" mechanic, which will become too complex to maintain and keep intuitive for the player.

<p>Though, despite the hours spent, I still felt that I had absolutely no game yet, only an engine, so I made this meme to represent my impression:
<p><img src="images/js13k21/day8.png" width=400>

<p>At the end, I started looking for a way to produce music... (super early compared to the other years!)
<p>I started by trying to reproduce classic melodies from their piano partitions, but it ended up being a dead-end. Partitions are an unbelievable mess of complexity, I don't have to work them out and develop a game at the same time!

<br>
<p><b>Total</b>: 27h15, 39kb. <a href="https://www.youtube.com/watch?v=WL_7_bZi9MM">Watch day 8 timelapse</a> / <a href="https://www.youtube.com/watch?v=2lHMBZIT8D4">Watch day 9 timelapse</a>

<br><br><hr><br>
<!--
<h2>Day 10</h2>





<br>
<p><b>Total</b>: ...h, ...kb. <a href="">Watch timelapse</a>


<br><br><hr><br>

<h2>Day 11</h2>





<br>
<p><b>Total</b>: ...h, ...kb. <a href="">Watch timelapse</a>

<br><br><hr><br>

<h2>Day 12</h2>





<br>
<p><b>Total</b>: ...h, ...kb. <a href="">Watch timelapse</a>

<br><br><hr><br>

<h2>To be continued...</h2>


-->


<br><br><hr><br>
<h1>TO BE CONTINUED</h1>
<br>
<br>
<br>
 
</div>


</main>

</div>

<footer></footer>

<script src="../ui.js"></script>
<script>
header();
footer();
menu();
</script>

</body>
</html>